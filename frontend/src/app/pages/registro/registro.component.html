<div class="p-6 max-w-5xl mx-auto text-text-light dark:text-text-dark">
  <h2 class="text-2xl font-bold mb-6 text-center">Registro de Usuario</h2>

  <form
    [formGroup]="usuarioForm"
    (ngSubmit)="registrarUsuario()"
    class="grid grid-cols-1 md:grid-cols-2 gap-6"
  >
    <div>
      <label for="nombres" class="block mb-1 font-medium">Nombres</label>
      <input
        id="nombres"
        type="text"
        formControlName="nombres"
        class="w-full px-3 py-2 border rounded bg-background-light text-text-light border-muted-light dark:bg-background-dark dark:text-text-dark dark:border-muted-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"
      />
      <p *ngIf="usuarioForm.get('nombres')?.invalid && usuarioForm.get('nombres')?.touched"
         class="text-red-500 text-sm mt-1">
        El nombre es obligatorio.
      </p>
    </div>

    <div>
      <label for="apellidos" class="block mb-1 font-medium">Apellidos</label>
      <input
        id="apellidos"
        type="text"
        formControlName="apellidos"
        class="w-full px-3 py-2 border rounded bg-background-light text-text-light border-muted-light dark:bg-background-dark dark:text-text-dark dark:border-muted-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"
      />
      <p *ngIf="usuarioForm.get('apellidos')?.invalid && usuarioForm.get('apellidos')?.touched"
         class="text-red-500 text-sm mt-1">
        Los apellidos son obligatorios.
      </p>
    </div>

    <div>
      <label for="username" class="block mb-1 font-medium">Nombre de usuario</label>
      <input
        id="username"
        type="text"
        formControlName="username"
        class="w-full px-3 py-2 border rounded bg-background-light text-text-light border-muted-light dark:bg-background-dark dark:text-text-dark dark:border-muted-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"
      />
      <p *ngIf="usuarioForm.get('username')?.invalid && usuarioForm.get('username')?.touched"
         class="text-red-500 text-sm mt-1">
        El nombre de usuario es obligatorio.
      </p>
    </div>

    <div>
      <label for="dni" class="block mb-1 font-medium">DNI</label>
      <input
        id="dni"
        type="text"
        maxlength="8"
        formControlName="dni"
        class="w-full px-3 py-2 border rounded bg-background-light text-text-light border-muted-light dark:bg-background-dark dark:text-text-dark dark:border-muted-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"
      />
      <p *ngIf="usuarioForm.get('dni')?.invalid && usuarioForm.get('dni')?.touched"
         class="text-red-500 text-sm mt-1">
        El DNI es obligatorio.
      </p>
    </div>

    <div>
      <label for="password" class="block mb-1 font-medium">Contraseña</label>
      <input
        id="password"
        type="password"
        formControlName="password"
        class="w-full px-3 py-2 border rounded bg-background-light text-text-light border-muted-light dark:bg-background-dark dark:text-text-dark dark:border-muted-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"
      />
      <p *ngIf="usuarioForm.get('password')?.invalid && usuarioForm.get('password')?.touched"
         class="text-red-500 text-sm mt-1">
        La contraseña es obligatoria.
      </p>
    </div>

    <div>
      <label for="repeatPassword" class="block mb-1 font-medium">Repetir contraseña</label>
      <input
        id="repeatPassword"
        type="password"
        formControlName="repeatPassword"
        class="w-full px-3 py-2 border rounded bg-background-light text-text-light border-muted-light dark:bg-background-dark dark:text-text-dark dark:border-muted-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"
      />
      <p *ngIf="usuarioForm.get('repeatPassword')?.invalid && usuarioForm.get('repeatPassword')?.touched"
         class="text-red-500 text-sm mt-1">
        Repite la contraseña.
      </p>
    </div>

    <div>
      <label for="email" class="block mb-1 font-medium">Correo electrónico</label>
      <input
        id="email"
        type="email"
        formControlName="email"
        class="w-full px-3 py-2 border rounded bg-background-light text-text-light border-muted-light dark:bg-background-dark dark:text-text-dark dark:border-muted-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"
      />
      <p *ngIf="usuarioForm.get('email')?.invalid && usuarioForm.get('email')?.touched"
         class="text-red-500 text-sm mt-1">
        El correo es obligatorio.
      </p>
    </div>

    <div *ngIf="isAdmin()" class="md:col-span-1">
      <label for="rol" class="block mb-1 font-medium">Rol</label>
      <app-custom-select-enum
        [items]="roles"
        [selectedId]="usuarioForm.get('rol')?.value ?? undefined"
        (selectionChange)="usuarioForm.get('rol')?.setValue($event !== null ? $event.toString() : null)"
        placeholder="Selecciona un rol"
      ></app-custom-select-enum>
    </div>

    <div class="md:col-span-2 flex justify-end">
      <button
        type="submit"
        [disabled]="usuarioForm.invalid"
        class="bg-primary-light dark:bg-primary-dark text-white px-6 py-2 rounded hover:opacity-90 transition disabled:opacity-50 disabled:cursor-not-allowed"
      >
        Registrarse
      </button>
    </div>
  </form>
</div>
